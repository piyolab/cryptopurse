!function(e){var t={};function n(o){if(t[o])return t[o].exports;var a=t[o]={i:o,l:!1,exports:{}};return e[o].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t){const n=ethereumjs.Wallet,o=ethereumjs.Util,a=ethereumjs.Tx,r={Keys:{KEY_ETH_ADDRESS:"KEY_ETH_ADDRESS",KEY_ETH_PRIVATE_KEY:"KEY_ETH_PRIVATE_KEY",KEY_ETH_CREATED_AT:"KEY_ETH_CREATED_AT",KEY_ETH_GAS_PRICE:"KEY_ETH_GAS_PRICE",KEY_ETH_TOKENS:"KEY_ETH_TOKENS"},ETH_GAS_LIMIT:21e3,ETH_DEFAULT_GAS_PRICE:2e10,HTTP_PROVIDERS:["https://mainnet.infura.io","","https://ropsten.infura.io"],ETHERSCAN_URLS:["https://etherscan.io/","","https://ropsten.etherscan.io/"]};let l={web3:null,wallet:null,chainId:1};const i=[{constant:!0,inputs:[],name:"symbol",outputs:[{name:"symbol",type:"string"}],type:"function"},{constant:!0,inputs:[{name:"_owner",type:"address"}],name:"balanceOf",outputs:[{name:"balance",type:"uint256"}],type:"function"},{constant:!0,inputs:[],name:"decimals",outputs:[{name:"",type:"uint8"}],type:"function"},{constant:!1,inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],name:"transfer",outputs:[{name:"",type:"bool"}],type:"function"}],s="Something Wrong ><...";var c=document.createElement("video"),d=document.getElementById("reader-camera-preview"),u=d.getContext("2d"),m=$("#reader-loading-message"),f=new QRCodeReader(jsQR,c,u);function g(e){const t=e.getAddressString(),n=e.getPrivateKeyString();localStorage.setItem(r.Keys.KEY_ETH_ADDRESS,t),localStorage.setItem(r.Keys.KEY_ETH_PRIVATE_KEY,n),localStorage.setItem(r.Keys.KEY_ETH_CREATED_AT,Math.floor(Date.now()/1e3))}function p(){$("#my-address").val(l.wallet.getAddressString())}function E(){const e=l.wallet.getAddressString();$("#my-address-balance").text("...");l.web3.eth.getBalance(e,function(e,t){if(e)alert(s);else{let e=l.web3.fromWei(t,"ether");e=e.toFormat(6,l.web3.BigNumber.ROUND_DOWN),$("#my-address-balance").text(e)}})}function w(e,t,n){let o=l.web3.eth.contract(i).at(t);o.balanceOf(e,(e,t)=>{o.decimals((e,o)=>{t=t.div(10**o),console.log(t.toString()),n(e,t)})})}function h(){const e=l.wallet.getAddressString();let t=localStorage.getItem(r.Keys.KEY_ETH_TOKENS);if(null!=t&&""!=t){t=JSON.parse(t),$("#token-balances").show();for(let n of t)w(e,n.address,(e,t)=>{e||$("<h6/>",{class:"card-subtitle mb-2 text-muted",html:"> "+t+" "+n.symbol}).appendTo("#token-balances")})}}function v(e){const t=l.web3.fromWei(e,"gwei");return!isNaN(t)&&t>=1&&t<=99}function _(){return l.web3.fromWei(function(){let e=localStorage.getItem(r.Keys.KEY_ETH_GAS_PRICE);return v(e)||(e=r.ETH_DEFAULT_GAS_PRICE),e}(),"gwei")}function b(e){v(e)&&localStorage.setItem(r.Keys.KEY_ETH_GAS_PRICE,e)}function y(e){const t=l.wallet.getAddressString(),n=$("#to-address").val(),i=$("#to-amount").val(),c=l.web3.toWei(i,"ether");o.isValidAddress(n)?c<=0?alert("Please enter a valid amount."):function(e,t){l.web3.eth.getTransactionCount(e,function(e,n){if(e)alert(s),console.error(e);else{const e=l.web3.toHex(n);t(e)}})}(t,function(t){const i=l.web3.toHex(r.ETH_DEFAULT_GAS_PRICE),d=l.web3.toHex(r.ETH_GAS_LIMIT),u=l.web3.toHex(c),m=function(e,t,n,o,r){const i={nonce:e,to:t,gasPrice:n,gasLimit:o,value:r,chainId:l.chainId};return new a(i)}(t,n,i,d,u);m.sign(o.toBuffer(l.wallet.getPrivateKeyString())),function(e,t){l.web3.eth.sendRawTransaction(e,function(e,n){e?(alert(s),console.error(e)):t(n)})}("0x"+m.serialize().toString("hex"),function(t){e(t)})}):alert("Please enter a valid address.")}function T(){$("#adjust-gas-modal-btn").on("click",function(e){$("#gasprice-amount").val(_())}),$("#adjust-gas-reset-btn").on("click",function(e){b(r.ETH_DEFAULT_GAS_PRICE),$("#gasprice-amount").val(_()),D("Saved!")}),$("#adjust-gas-save-btn").on("click",function(e){!function(e){b(l.web3.toWei(e,"gwei"))}($("#gasprice-amount").val()),$("#gasprice-amount").val(_()),D("Saved!")})}function S(){$("#to-address").on("focus",function(){$(this).select()}),$("#send-eth-to-confirm-btn").on("click",function(){!function(){var e=null,t=null;const n=$("#to-address").val(),a=$("#to-amount").val(),r=l.web3.toWei(a,"ether");!o.isValidAddress(n)||r<=0?($("#send-eth-btn").hide(),t="Error",e="Enter a valid address and amount."):($("#send-eth-btn").show(),t="Are you sure?",e="You are about to send "+$("#to-amount").val()+" ETH to "+$("#to-address").val()),$("#send-eth-confirm-modal-title").text(t),$("#send-eth-confirm-modal-msg").text(e)}()}),$("#send-eth-btn").on("click",function(){$("#send-eth-confirm-modal").modal("toggle"),y(function(e){const t=r.ETHERSCAN_URLS[l.chainId-1],n=$("<a></a>",{href:t+"tx/"+e,target:"_blank",text:"Check the tx in etherscan.io"});$("#tx-result-modal-msg").html(n),$("#tx-result-modal").modal("toggle")})})}function k(){$("#my-address-share-btn").on("click",function(){$("#share-output").val(H(0)),$("#share-modal").modal("toggle")}),$("#share-amount").on("input",function(e){let t=$("#share-amount").val();isNaN(t)||$("#share-output").val(H(t))}),$("#share-output-copy-btn").on("click",function(e){Clipboard.copyOnModal($("#share-output").val(),$("#share-modal").get(0)),D("Copied!")})}function A(){$("#export-wallet-btn").on("click",function(){$("#privatekey-output").val(l.wallet.getPrivateKeyString()),$("#export-wallet-modal").modal("toggle"),$("#privatekey-output-modal").modal("toggle")}),$("#privatekey-output").on("focus",function(){$(this).select()}),$("#privatekey-output-copy-btn").on("click",function(){$("#privatekey-output").select(),Clipboard.copyOnModal(l.wallet.getPrivateKeyString(),$("#privatekey-output-modal").get(0)),D("Copied!")})}function K(){$("#import-wallet-btn").on("click",function(){$("#import-wallet-modal").modal("toggle"),$("#privatekey-input-modal").modal("toggle")}),$("#privatekey-input-btn").on("click",function(){!function(){const e=$("#privatekey-input").val(),t=o.toBuffer(e);try{l.wallet=n.fromPrivateKey(t),g(l.wallet),p(),$("#privatekey-input-modal").modal("toggle"),E(),h()}catch(e){console.error(e),alert(e)}}()})}function I(){$("#erc20-token-address").change(function(){const e=$("#erc20-token-address").val();console.log(e),l.web3.eth.contract(i).at(e).symbol((e,t)=>{null==e&&(console.log(t),$("#erc20-token-symbol").val(t))})}),$("#add-erc20-token-save-btn").on("click",function(){const e=$("#erc20-token-address").val(),t=$("#erc20-token-symbol").val();""!=e&&""!=t&&(!function(e,t){const n={address:e,symbol:t};let o=localStorage.getItem(r.Keys.KEY_ETH_TOKENS);null==o||""==o?o=[n]:(o=JSON.parse(o)).push(n);localStorage.setItem(r.Keys.KEY_ETH_TOKENS,JSON.stringify(o))}(e,t),$("#add-erc20-token-modal").modal("toggle"))})}function R(){null!=l.wallet?($("#my-address-balance-reload-btn").on("click",function(){E(),h()}),$("#my-address-copy-btn").on("click",function(e){const t=l.wallet.getAddressString();Clipboard.copy(t),D("Copied!")}),$("#my-address-qr-btn").on("click",function(){const e=l.wallet.getAddressString();$("#qrcode-modal-msg").text(e),$("#qrcode").empty(),new QRCode(document.getElementById("qrcode"),e)}),S(),$("#qrcode-reader-modal").on("show.bs.modal",function(){f.start(function(){m.text("⌛ Loading video...")},function(e){$("#reader-loading-message").text("🙅‍♀️"+e.name)})}),$("#qrcode-reader-modal").on("hide.bs.modal",function(e){f.stop()}),A(),K(),k(),T(),I()):$("#create-wallet-btn").on("click",function(){l.wallet=n.generate(),g(l.wallet),window.location.reload()})}function H(e){let t="https://cryptopurse.app/eth/?to="+l.wallet.getAddressString();return e>0&&null!=e&&(t=t+"&value="+e),t}function P(){if(function(){const e=window.navigator.userAgent.toLowerCase();return chrome=/crios/.test(e),!!chrome}())return!1;var e=window.navigator.standalone,t=window.navigator.userAgent.toLowerCase(),n=/safari/.test(t),o=/iphone|ipod|ipad/.test(t);return!!(o&&!e&&!n||o&&!x())}function x(){return void 0!=navigator.mediaDevices&&void 0!=navigator.mediaDevices.getUserMedia}function C(){P()?($("#webview-warning").show(),$("#browser-link").text(location.href)):null==l.wallet&&$("#create-wallet").show(),function(){x()||$("#to-address-read-from-camera").hide();(null==l.wallet||P())&&($("#main-contents").hide(),$("#navbarToggleButton").hide())}()}function Y(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===t?null:decodeURIComponent(t[1].replace(/\+/g," "))}function D(e){$("<div>",{id:"snackbar",text:e}).appendTo("body"),$("#snackbar").addClass("show"),setTimeout(function(){$("#snackbar").remove()},1e3)}f.onPreview=function(e){m.hide(),d.hidden=!1,d.height=e.videoHeight,d.width=e.videoWidth,u.drawImage(e,0,0,d.width,d.height)},f.onData=function(e){l.web3.isAddress(e)?($("#qrcode-reader-modal").modal("hide"),$("#to-address").val(e)):console.error("Invalid data: "+e)},$(document).ready(function(){!function(e){const t=localStorage.getItem(r.Keys.KEY_ETH_PRIVATE_KEY);if(null==t||""==t);else{const e=o.toBuffer(t);l.wallet=n.fromPrivateKey(e)}e()}(function(){var e,t;l.wallet&&(e=function(e){var t,n;!function(e){e.to&&$("#to-address").val(e.to),e.value&&$("#to-amount").val(e.value),e.network&&(l.chainId=parseInt(e.network))}(e),function(e){l.web3=new Web3(new Web3.providers.HttpProvider(e))}((t=e.network,n=r.HTTP_PROVIDERS[0],null!=t&&t<=r.HTTP_PROVIDERS.length&&(n=r.HTTP_PROVIDERS[t-1]),n))},(t={}).to=Y("to"),t.value=Y("value"),t.network=Y("network"),e(t),function(){const e=r.ETHERSCAN_URLS[l.chainId-1]+"address/"+l.wallet.getAddressString();$("#etherscan-link").attr("href",e),p(),E(),h()}())}),R(),C()})}]);